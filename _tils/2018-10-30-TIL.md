---
layout: post
title: 2018-10-30 TIL
description: "TIL"
tags: [TIL, 강의노트]
---

## 방통대 강의노트 (UNIX 시스템, 데이터베이스 설계 및 구현)

### UNIX 시스템 (프로세스 관리)

#### 프로세스

> 커널에 등록되어 관리를 받는 작업 또는 실행중인 프로그램

- 각 프로세스는 유일한 PID 를 가짐
  - init 프로세스는 PID 가 1
- 프로세스 관리블록(PCB)에 프로세스에 관한 정보를 저장
  - 프로세스는 커널공간에 자신의 정보를 가짐
  - PID, PPID(부모), UID/EUID(실사용자), GID/EGID, 현재상태, 우선순위, 사용자원정보, 문맥교환 정보, 대기 시그널 등
- 필요에 따라 프로세스는 자식 프로세스를 실행함
- 데몬 프로세스는 서비스 요청을 처리하기 위한 백그라운드 프로세스

#### 프로세스의 실행

- 시스템 호출 `fork()`를 호출하여 기존 부모 프로세스가 `자신의 복사본 자식 프로세스`를 만듦
- 자식 프로세스는 시스템 호출 `exec(program)`에 의해 새로운 프로그램으로 `대체`되어 실행됨
- 프로그램이 종료되면 자식 프로세스가 종료됨
- 부모 프로세스는 보류상태에 있다가 자식 프로세스가 종료되고 깨어남

#### 포어그라운드 & 백그라운드

- 포어그라운드 실행 중 `ctrl+z`하면 백그라운드로 전환, 멈춤(또는 지연) 상태로 전환
  - `fg jobid` 또는 `bg jobid`로 실행상태로 전환가능
- 쉘 프롬프트에서 명령의 끝에 `&`를 추가하여 실행하면 백그라운드 실행
  - 백그라운드 프로세스가 키보드 입력이 필요하면 지연상태가 됨
  - 터미널 창을 종료하면 연결된 모든 백그라운드 프로세스도 종료
  - `jobs` (백그라운드 프로세스의 상태 점검 `-ㅣ` 옵션으로 PID 도 같이 볼수있다.)

#### 특수권한

- `SetUID`
  - 파일 접근권한에서 소유자의 실행권한에 x 가 아닌 s 인 경우
  - 파일이 실행될 때, 실행 사용자가 아닌 `파일의 소유자`권한으로 실행됨
  - `chmod u+s file`로 설정 `chmod u-s file`로 해제
- `SetGID`
  - 그룹버전
  - 디렉토리의 경우 파일을 만들 때 파일의 소유그룹이 `디렉터리의 소유그룹`으로 지정됨
  - `chmod 2775 file` 또는 `chmod g+s file`
- `StickyBit`
  - 파일의 접근권한에 기타사용자의 실행권한이 t
  - 주로 `공유 디렉터리`에 설정됨.
  - 누구나 그 디렉터리에 파일생성이 가능하나 파일소유자만 삭제가능
  - `chmod 1755 file` 또는 `chmod o+t file`

#### 프로세스의 상태

- `ps`
  - 현재 프로세스의 상태확인 (특정 순간에 활동중인 프로세스의 상태)
  - 옵션이 없는 경우 터미널 연결 프로세스 중 EUID 가 현재 사용자의 UID 와 같은 프로세스를 보여줌
  - `TTY`는 사용 터미널, `TIME`은 CPU 누적 사용시간

#### 프로세스 관리

- `top`
  - 현재 실행중인 프로세스의 모니터링과 관리를 위한 대화식 도구
  - CPU, 메모리 사용량, 시스템의 부하확인
  - 실시간 정보를 주기적으로 보여줌
- `kill`
  - 프로세스에 시그널을 보내는 명령
  - 다른 프로세스에게 시그널을 보내도록 커널에게 요청하는 것
  - 여러 종류의 시그널이 존재. 기본은 `TERM`(정상종료)
  - `kill -STOP pid` : 해당 PID 를 가진 프로세스에게 멈춤 시그널을 보냄
- `killall [Options] [-s signal] [-u user] names`
  - 특정 프로세스에 한꺼번에 시그널을 보내는 명령
  - 프로그램이나 프로세스의 이름을 사용
- `nice [Options] [-20~19]`
  - 우선순위 값을 조정하는 명령
  - 우선순위가 높으면 CPI 를 점유할 확률이 높음
  - 일반 사용자는 0 이상으로만 지정할 수 있음
- `renice`
  - 실행 중인 프로세스의 우선순위 절대값을 바꾸는 명령
  - 일반 사용자는 자신이 소유한 프로세스의 우선순위만 낮출 수 있음
- `nohup`
  - `HUP`시그널과 무관하게 명령이 스스로 종료될 때 까지 계속 수행시킴
  - 로그아웃/터미널 창을 끝내면 프로세스에 `HUP`시그널이 보내짐
  - nohup 실행시 명령행 끝에 `&`를 붙여 백그라운드로 실행해야 함

#### Cron 서비스

> 지정된 시간에 주기적으로 자동 수행되는 작업을 수행함

- `crond` 데몬프로그램이 서비스를 제공
- 1 분간격으로 `crontab` 파일을 검사하여 수행함
- `/etc/crontab` 파일, `/etc/cron.d/` 디렉토리에 존재하는 파일
  - 시스템 수준에서 주기적으로 실행될 작업지정
- 분 시 날짜 달 요일(0-7) 형식
  - `*`는 매번, 간격은 `/`, 범위는 `-` 또는 `,`
- `crontab` 명령
  - 일반 사용자가 자신의 작업을 자신의 crontab 파일에 등록할 때 사용
  - `/var/spool/cron/username` 파일로 만들어지나 직접 수정권한 없음
  - 지정된 시간에 일회성으로 작업을 예약하려면 `at` 명령을 사용

---

### 데이터베이스 설계 및 구현 (데이터 검색)

#### 질의문

- `DISTINCT`

  - 검색결과에 중복되는 레코드를 제거
  - 컬럼값이 아닌 레코드 단위의 종복을 제거

- `LIMIT`
  - 검색결과에 포함되는 레코드 개수를 제한
